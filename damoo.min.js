/*! Damoo v2.3.0 | Copyright (c) 2015-2019 James Liu | Released under the MIT license */
;(function(b){function k(){this.canvas.clear();for(var a=0;a<this.thread.pool.length;a++){var c=this.thread.get(a),b=c.offset.x;this.canvas.draw(c,b,c.offset.y);c.offset.x-=c.speed;b<=-c.canvas.width&&this.thread.remove(a)}this._afid=m(k.bind(this))}var d=function(a,c,b,d){this.canvas=new h(a,c,b,d);this.thread=new g(b)};d.prototype.show=function(){this.canvas.parent.appendChild(this.canvas.layer);return this};d.prototype.hide=function(){this.canvas.parent.removeChild(this.canvas.layer);return this};d.prototype.emit=function(a){"string"===typeof a&&(a={text:a});var c=a,b=this.canvas.font,f=d.dom.createElement("canvas"),e=f.getContext("2d");e.font=b;f.width=e.measureText(c.text).width;f.height=1.5*b.size;e.font=b;e.textAlign="start";e.textBaseline="top";c.shadow&&(e.shadowOffsetX=1,e.shadowOffsetY=1,e.shadowColor="#fff",e.shadowColor=c.shadow.color);e.fillStyle="#fff";e.fillStyle=c.color;e.fillText(c.text,0,0);this.thread.push({canvas:f,fixed:a.fixed,index:this.thread.index,speed:.6*Math.pow(f.width,1/3),offset:{x:this.canvas.width,y:this.canvas.font.size*this.thread.index}});return this};d.prototype.clear=function(){this.thread.empty();return this};d.prototype.play=function(){void 0===this.state&&this.clear().show();this.state||(k.call(this),this.state=1);return this};d.prototype.pause=function(){if(void 0===this.state)return this;n(this._afid);this.state=0;return this};d.prototype.resume=function(){return this.play()};var m=b.requestAnimationFrame||b.mozRequestAnimationFrame||b.webkitRequestAnimationFrame||b.msRequestAnimationFrame||b.oRequestAnimationFrame||function(a){return setTimeout(a,17)},n=b.cancelAnimationFrame||b.mozCancelAnimationFrame||b.webkitCancelAnimationFrame||b.webkitCancelRequestAnimationFrame||b.msCancelAnimationFrame||b.oCancelAnimationFrame||function(a){return clearTimeout(a)},h=function(a,c,g,f){this.dpr=b.devicePixelRatio||1;this.parent=1==a.nodeType?a:d.dom.getElementById(a);this.id=c;this.rows=g;this.width=this.parent.offsetWidth*this.dpr;this.height=this.parent.offsetHeight*this.dpr;12>this.height/this.rows&&(this.rows=this.height/12);this.font=new l(this.height/this.rows,f);this.layer=d.dom.createElement("canvas");this.context=this.layer.getContext("2d");this.layer.id=this.id;this.layer.width=this.width;this.layer.height=this.height;this.layer.style.width=this.width/this.dpr+"px";this.layer.style.height=this.height/this.dpr+"px";this.layer.style.display="block";this.layer.style.backgroundColor="transparent";this.parent.style.position?(this.layer.style.position="fixed",this.layer.style.left=this.parent.offsetLeft,this.layer.style.top=this.parent.offsetTop):(this.parent.style.position="relative",this.layer.style.position="absolute",this.layer.style.left=0,this.layer.style.top=0);this.layer.style.zIndex=999};h.prototype.clear=function(){this.context.clearRect(0,0,this.width,this.height)};h.prototype.draw=function(a,c,b){a.fixed&&(c=(this.width-a.canvas.width)/2);this.context.drawImage(a.canvas,c,b)};var l=function(a,b){this.size=a;this.family=b||"sans-serif"};l.prototype.toString=function(){return this.size+"px "+this.family};var g=function(a){this.index=0;this.rows=a;this.pool=[]};g.prototype.push=function(a){this.index++;this.index>=this.rows&&(this.index=0);this.pool.push(a)};g.prototype.get=function(a){return this.pool[a]};g.prototype.remove=function(a){var b=this.get(a).index;this.index>b&&(this.index=b);this.pool.splice(a,1)};g.prototype.empty=function(){this.index=0;this.pool=[]};d.version="v2.3.0";d.dom=b.document;b.Damoo=d})(window);